<dx-data-grid [dataSource]="dataSource"
              (rowClick)="rowClick($event)"
              [allowColumnResizing]="true"
              [columnAutoWidth]="true"
              [showBorders]="true">

  <dxi-column type="buttons" caption="Actions" [width]="120">
    <dxi-button icon="edit" hint="Edit" [onClick]="onEditClick.bind(this)"></dxi-button>
    <dxi-button icon="trash" hint="Delete" [onClick]="onDeleteClick.bind(this)"></dxi-button>
  </dxi-column>



  <dxo-paging [pageSize]="10"></dxo-paging>
  <dxo-pager [showPageSizeSelector]="true"
             [allowedPageSizes]="[5, 10, 20]"
             [showInfo]="true"></dxo-pager>
  <dxo-filter-row [visible]="true"></dxo-filter-row>

  <dxi-column dataField="name" caption="Name"></dxi-column>
  <dxi-column dataField="phone" caption="Phone" [customizeText]="customizePhoneCell"></dxi-column>
  <dxi-column dataField="email" caption="Email"></dxi-column>
  <dxi-column dataField="type"
              caption="Type"
              [cellTemplate]="'typeCellTemplate'"></dxi-column>
  <dxi-column dataField="status"
              caption="Status"
              [cellTemplate]="'statusCellTemplate'"></dxi-column>
  <dxi-column dataField="createdAt"
              caption="Created Date"
              [customizeText]="formatDate"></dxi-column>

  <div *dxTemplate="let cell of 'typeCellTemplate'">
    <i [class]="'dx-icon-' + getTypeIcon(cell.value)"></i> {{ cell.value }}
  </div>

  <div *dxTemplate="let cell of 'statusCellTemplate'">
    <span [class]="getStatusClass(cell.value)">{{ cell.value }}</span>
  </div>

  <dxo-toolbar>
    <dxi-item location="before">
      <dx-button icon="plus"
                 text="Add Customer"
                 (onClick)="addCustomer()"></dx-button>
    </dxi-item>
    <dxi-item location="after">
      <dx-drop-down-button [items]="filterStatusList"
                           text="Filter by Status"
                           (onItemClick)="filterByStatus($event)"></dx-drop-down-button>
    </dxi-item>
    <dxi-item location="after">
      <dx-drop-down-button [items]="filterTypeList"
                           text="Filter by Type"
                           (onItemClick)="filterByType($event)"></dx-drop-down-button>
    </dxi-item>
    <dxi-item location="after">
      <dx-button icon="refresh"
                 text="Refresh"
                 (onClick)="refresh()"></dx-button>
    </dxi-item>
  </dxo-toolbar>
</dx-data-grid>

<dx-popup [title]="popupTitle"
          [visible]="isAddCustomerPopupOpened || isEditCustomerPopupOpened"
          (onHiding)="onCancelEdit()"
          [width]="500"
          [height]="500">
  <div *dxTemplate="let context of 'content'">
    <h2>{{popupTitle}}</h2>
    <div class="form-group">
      <label>Name</label>
      <dx-text-box [(value)]="currentCustomer.name"></dx-text-box>
    </div>
    <div class="form-group">
      <label>Phone</label>
      <dx-text-box [(value)]="currentCustomer.phone"></dx-text-box>
    </div>
    <div class="form-group">
      <label>Email</label>
      <dx-text-box [(value)]="currentCustomer.email"></dx-text-box>
    </div>
    <div class="form-group">
      <label>Type</label>
      <dx-select-box [items]="typeList" [(value)]="currentCustomer.type"></dx-select-box>
    </div>
    <div class="form-group">
      <label>Status</label>
      <dx-select-box [items]="statusList" [(value)]="currentCustomer.status"></dx-select-box>
    </div>
    <div class="button-group">
      <dx-button text="Save" type="success"
                 (onClick)="popupTitle === 'Add Customer' ? onSaveNewCustomer() : onSaveEditedCustomer()">
      </dx-button>
      <dx-button text="Cancel" type="normal" (onClick)="onCancelEdit()"></dx-button>
    </div>
  </div>
</dx-popup>
